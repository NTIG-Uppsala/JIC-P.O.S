# How to Deploy the API

This guide outlines how to deploy and configure the API via the commandline. For this setup, we used [DigitalOcean](https://www.digitalocean.com/) droplets to create a simple VPS for hosting the API.

---

## Deploying the API on a Server

### Steps to Set Up the API
> **Note:** This assumes that you already have a working database with the correct structure. For details, see the [API Database Setup](/Documents/ApiDatabaseSetup.md).

1. **Clone the Repository**  
   Start by cloning the entire repository onto your server:
   ```bash
   git clone <repository_url>
   ```

2. **Install Node.js**  
   If Node.js is not already installed on your server, you need to install it first. Use the following commands to install Node.js and npm (Node.js package manager) on Ubuntu-based systems:
   ```bash
   sudo apt update
   sudo apt install -y nodejs npm
   ```

   You can check if Node.js and npm are installed correctly by running:
   ```bash
   node -v
   npm -v
   ```

3. **Install Dependencies**  
   Navigate to the project directory and install all necessary dependencies using npm:
   ```bash
   cd <project_directory>
   npm install
   ```

4. **Create a `.env` File**  

   The API requires specific environment variables to run correctly. You can find the required structure in the [`.env.example`](../API/.env.example) file.

   In the root directory of the project (where `app.js` is located), create a `.env` file and add the necessary variables.

   You can create and set up the `.env` file via the command line with the following steps:

   1. Navigate to the root directory of the project:
      ```bash
      cd <project_directory>
      ```

   2. Copy the `.env.example` file to `.env`:
      ```bash
      cp .env.example .env
      ```

   3. Open the `.env` file in your preferred text editor (e.g., nano):
      ```bash
      nano .env
      ```

   4. Modify the values as needed and save the changes.

5. **Start the API**  
   Run the following command to start the server:
   ```bash
   node app.js
   ```
   The API should now be accessible on the configured IP and port. For a list of endpoints, refer to the [API Endpoints documentation](/Documents/ApiEndpoints.md).

---


## Configuring the API to Run Continuously

To ensure the API remains active even after you close the console, you can configure it to run as a systemd service.

### Steps to Configure a systemd Service

1. **Create a Systemd Service File**  
   Add a systemd service file at `/etc/systemd/system/API.service` with the following content:
   ```ini
   [Unit]
   Description=Node.js API Service
   After=network.target

   [Service]
   Group=www-data
   WorkingDirectory=/var/www/JIC-P.O.S/API
   ExecStart=/usr/bin/node /var/www/JIC-P.O.S/API/app.js
   Restart=always

   [Install]
   WantedBy=multi-user.target
   ```

   > **Note:** Update the file paths (`/var/www/JIC-P.O.S/API`) to match the actual location of your API files. It's recommended to place your application in `/var/www` (create this directory if it does not exist).

2. **Enable and Start the Service**  
   Use the following commands to enable and start the service:
   ```bash
   sudo systemctl enable API.service
   sudo systemctl start API.service
   ```

3. **Verify the Service**  
   Check the status of the service to ensure it is running:
   ```bash
   sudo systemctl status API.service
   ```

---

## Useful Commands for Managing the API Service

- **Restart the Service**  
  To restart the API service after making changes:
  ```bash
  sudo systemctl restart API.service
  ```

- **Stop the Service**  
  To stop the API service:
  ```bash
  sudo systemctl stop API.service
  ```

- **View Logs**  
  To view logs generated by the service:
  ```bash
  journalctl -u API.service
  ```

---

With these steps completed, your API should be deployed and running continuously on the server.

---

[Back to README](../README.md)
